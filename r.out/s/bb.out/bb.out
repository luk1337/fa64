#!/bin/sh
### FDE.AI v4 | FeraVolt. 2019 ###
. /fde.ai/s/libfde.so;
if [ "$CA" -le "3351" ];then setprop net.tcp.buffersize.hsdpa 4096,32768,65536,4096,32768,65536;setprop net.tcp.buffersize.hspa 4096,32768,65536,4096,32768,65536;setprop net.tcp.buffersize.hspap 4096,32768,65536,4096,32768,65536;setprop net.tcp.buffersize.hsupa 4096,32768,65536,4096,32768,65536;setprop net.tcp.buffersize.umts 4095,87380,110208,4096,32768,110208;if [ -n "$RUS" ];then flog "- Сетевое соединение настроено для энергосбережения";else flog "- Data conncetions tuned for power-saving";fi;fi;setprop net.tcp.buffersize.default 4094,87380,1220608,4096,32768,1220608;setprop net.tcp.buffersize.edge 4093,26280,35040,4096,16384,35040;setprop net.tcp.buffersize.evdo 4093,26280,35040,4096,16384,35040;setprop net.tcp.buffersize.gprs 4092,8760,11680,4096,8760,11680;setprop net.tcp.buffersize.wifi 4094,87380,1220608,4096,32768,1220608;if [ -n "$RUS" ];then flog "- Оптимизация сетевых буферов";else flog "- Network buffers optimized";fi;$B sysctl -e -w net.ipv4.tcp_ecn=2;$B sysctl -e -w net.ipv4.tcp_sack=1;$B sysctl -e -w net.ipv4.tcp_fack=1;$B sysctl -e -w net.ipv4.tcp_dsack=1;$B sysctl -e -w net.ipv4.tcp_tw_reuse=1;$B sysctl -e -w net.ipv4.tcp_delayed_ack=0;$B sysctl -e -w net.ipv4.tcp_timestamps=1;$B sysctl -e -w net.ipv4.tcp_window_scaling=1;$B sysctl -e -w net.ipv4.tcp_synack_retries=3;$B sysctl -e -w net.ipv4.tcp_keepalive_intvl=240;$B sysctl -e -w net.ipv4.tcp_keepalive_probes=5;$B sysctl -e -w net.ipv4.tcp_fin_timeout=45;$B sysctl -e -w net.ipv4.tcp_challenge_ack_limit=9999;$B sysctl -e -w net.ipv4.tcp_no_metrics_save=1;$B sysctl -e -w net.ipv4.tcp_slow_start_after_idle=0;$B sysctl -e -w net.ipv4.tcp_fastopen=3;$B sysctl -e -w net.ipv4.tcp_default_init_rwnd=60;$B sysctl -e -w net.ipv4.tcp_congestion_control=cubic;$B sysctl -e -w net.ipv4.tcp_congestion_control=htcp;$B sysctl -e -w net.ipv4.tcp_congestion_control=westwood;$B echo "2">/proc/sys/net/ipv4/tcp_ecn;$B echo "1">/proc/sys/net/ipv4/tcp_sack;$B echo "1">/proc/sys/net/ipv4/tcp_fack;$B echo "1">/proc/sys/net/ipv4/tcp_dsack;$B echo "1">/proc/sys/net/ipv4/tcp_tw_reuse;$B echo "0">/proc/sys/net/ipv4/tcp_delayed_ack;$B echo "1">/proc/sys/net/ipv4/tcp_timestamps;$B echo "1">/proc/sys/net/ipv4/tcp_window_scaling;$B echo "3">/proc/sys/net/ipv4/tcp_synack_retries;$B echo "240">/proc/sys/net/ipv4/tcp_keepalive_intvl;$B echo "5">/proc/sys/net/ipv4/tcp_keepalive_probes;$B echo "45">/proc/sys/net/ipv4/tcp_fin_timeout;$B echo "9999">/proc/sys/net/ipv4/tcp_challenge_ack_limit;$B echo "1">/proc/sys/net/ipv4/tcp_no_metrics_save;$B echo "0">/proc/sys/net/ipv4/tcp_slow_start_after_idle;$B echo "3">/proc/sys/net/ipv4/tcp_fastopen;$B echo "60">/proc/sys/net/ipv4/tcp_default_init_rwnd;$B echo "cubic">/proc/sys/net/ipv4/tcp_congestion_control;$B echo "htcp">/proc/sys/net/ipv4/tcp_congestion_control;$B echo "westwood">/proc/sys/net/ipv4/tcp_congestion_control;if [ -n "$RUS" ];then flog "- Оптимизирован сетевой стек ядра";else flog "- Optimized kernel network stack";fi;CON=$($B cat /proc/sys/net/ipv4/tcp_congestion_control);if [ -n "$RUS" ];then flog "- Контролер перегрузки TCP - $CON";else flog "- TCP congrestion controller - $CON";fi;if [ -d /sys/module/tcp_cubic ];then $B echo "2">/sys/module/tcp_cubic/parameters/hystart_detect;if [ -n "$RUS" ];then flog "- Оптимизация контролера перегрузки TCP";else flog "- TCP congrestion controller optimized";fi;fi;if [ -e /sys/class/net/wlan0/tx_queue_len ];then $B echo "3000">/sys/class/net/wlan0/tx_queue_len;if [ -n "$RUS" ];then flog "- Оптимизирована пропускная способность пакетов WiFi";else flog "- WiFi packets throughput optimized";fi;fi;exit;
